plot(matriz%*%b,dados$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
plot(matriz%*%b,dados$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
resid <- dados$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
plot(matriz%*%b,dados$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
#| fig-align: "center"
resid <- dados$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
mtext(paste("sigma=", sd(resid)))
plot(matriz%*%b,dados$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
#| fig-align: "center"
resid <- dados$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
mtext(paste("sigma=", sd(resid)),adj=-1)
plot(matriz%*%b,dados$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
#| fig-align: "center"
resid <- dados$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
mtext(paste("sigma=", sd(resid)),padj=-1)
plot(matriz%*%b,dados$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
#| fig-align: "center"
resid <- dados$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
mtext(paste("sigma=", sd(resid)),padj=3)
plot(matriz%*%b,dados$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
mtext(paste("EQM=",mean((dados$B2-matriz%*%b)^2)))
#| fig-align: "center"
resid <- dados$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
mtext(paste("EQM=",mean((dados$B2-matriz%*%b)^2)))
mtext(paste("EQM=",mean((dados$B2-matriz%*%b)^2)),side=1)
#| fig-align: "center"
resid <- dados$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
mtext(paste("EQM=",mean((dados$B2-matriz%*%b)^2)),side=1)
#| fig-align: "center"
resid <- dados$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
mtext(paste("EQM=",mean((dados$B2-matriz%*%b)^2)),side=1,padj=-4)
#| fig-align: "center"
resid <- dados$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
mtext(paste("EQM=",mean((dados$B2-matriz%*%b)^2)),side=1,padj=-2)
#| fig-align: "center"
resid <- dados$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
mtext(paste("EQM=",mean((dados$B2-matriz%*%b)^2)),side=1,padj=-2,col="blue4")
abline(a=0,b=1,lty=2,col="grey30")
#| fig-align: "center"
resid <- dados$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM=",mean((dados$B2-matriz%*%b)^2)),side=1,padj=-2,col="blue4")
#| fig-align: "center"
resid <- dados$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM=",mean((dados$B2-matriz%*%b)^2)),side=1,padj=-2,col="blue4")
#| fig-align: "center"
resid <- dados$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM=",round(mean((dados$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
matriz <- cbind(rep(1,27),as.matrix(dados[,-(1:2)]), dados$Humidade^2)
(b <-optim(par=c(110,0,0,0,0),minQuad)$par)
matriz <- cbind(rep(1,27),as.matrix(dados[,-(1:2)]), dados$Humidade^2)
(b <-optim(par=c(130,0,0,0,0),minQuad)$par)
matriz <- cbind(rep(1,27),as.matrix(dados[,-(1:2)]), dados$Humidade^2)
(b <-optim(par=c(120,0,3,0,0),minQuad)$par)
matriz <- cbind(rep(1,27),as.matrix(dados[,-(1:2)]), dados$Humidade^2)
(b <-optim(par=c(100,0,3,0,0),minQuad)$par)
matriz <- cbind(rep(1,27),as.matrix(dados[,-(1:2)]), dados$Humidade^2)
(b <-optim(par=c(110,0,3,0,0),minQuad)$par)
matriz <- cbind(rep(1,27),as.matrix(dados[,-(1:2)]), dados$Humidade^2)
(b <-optim(par=c(110,0,0,0,0),minQuad)$par)
matriz <- cbind(rep(1,27),as.matrix(dados[,-(1:2)]), dados$Humidade^2)
(b <-optim(par=c(119,0,0,0,0),minQuad)$par)
matriz <- cbind(rep(1,27),as.matrix(dados[,-(1:2)]), dados$Humidade^2)
(b <-optim(par=c(100,0,0,0,0),minQuad)$par)
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos",pch=2)
plot(dados$B2,resid,xlab="Vitamina B2",ylab="Resíduos",pch=3)
ID <- 1:20
Caro<- c(76,70,55,71,55,48,50,66,41,43,82,68,88,58,64,88,89,88,84,88)
Barato<- c(123,109,62,104,57,37,44,100,16,28,138,105,159,75,88,164,169,167,149,167)
#| code-fold: true
ID <- 1:20
Caro<- c(76,70,55,71,55,48,50,66,41,43,82,68,88,58,64,88,89,88,84,88)
Barato<- c(123,109,62,104,57,37,44,100,16,28,138,105,159,75,88,164,169,167,149,167)
dados.1 <- data.frame(ID,Caro,Barato)
rm(list=list(ID,Caro,Barato))
ls()
#| code-fold: true
ID <- 1:20
Caro<- c(76,70,55,71,55,48,50,66,41,43,82,68,88,58,64,88,89,88,84,88)
Barato<- c(123,109,62,104,57,37,44,100,16,28,138,105,159,75,88,164,169,167,149,167)
dados.1 <- data.frame(ID,Caro,Barato)
rm(list=c("ID","Caro","Barato"))
knitr::kable(dados.1)
#| code-fold: true
ID <- 1:27
B2 <-c(110.4,102.8,101.0,108.4,100.7,100.3,102.0,93.7,98.9,96.6,
99.4,96.2,99.0,88.4,75.3,92.0,82.4,77.1,74.0,65.7,56.8,62.1,61.0,53.2,59.4,58.7,58.0)
Sol <- c(176,155,273,273,256,280,280,184,216,
198,59,80,80,105,180,180,177,230,203,191,191,191,76,213,213,151,205)
Humidade <- c(7.0,7.0,7.0,7.0,7.0,7.0,7.0,7.0,7.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,
2.0,2.0,47.4,47.4,47.4,47.4,47.4,47.4,47.4,47.4,47.4)
Temp.Ar <- c(78,89,89,72,84,87,74,87,88,76,
65,67,62,70,73,65,76,82,76,83,82,69,74,76,69,75,76)
dados.2 <- data.frame(ID,B2,Sol,Humidade,Temp.Ar)
rm(list=c("ID","B2","Sol","Humidade","Temp.Ar"))
knitr::kable(dados.2)
minQuad <- function(b){
return(sum((dados.1$Caro-b[1]-dados.1$Barato*b[2])^2))
}
(b <-optim(par=c(0,0),minQuad)$par)
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2])
#| code-fold: true
ID <- 1:20
Caro<- c(76,70,55,71,55,48,50,66,41,43,82,68,88,58,64,88,89,88,84,88)
Barato<- c(123,109,62,104,57,37,44,100,16,28,138,105,159,75,88,164,169,167,149,167)
dados.1 <- data.frame(ID,Caro,Barato)
rm(list=c("ID","Caro","Barato"))
knitr::kable(dados.1)
#| code-fold: true
ID <- 1:27
B2 <-c(110.4,102.8,101.0,108.4,100.7,100.3,102.0,93.7,98.9,96.6,
99.4,96.2,99.0,88.4,75.3,92.0,82.4,77.1,74.0,65.7,56.8,62.1,61.0,53.2,59.4,58.7,58.0)
Sol <- c(176,155,273,273,256,280,280,184,216,
198,59,80,80,105,180,180,177,230,203,191,191,191,76,213,213,151,205)
Humidade <- c(7.0,7.0,7.0,7.0,7.0,7.0,7.0,7.0,7.0,2.0,2.0,2.0,2.0,2.0,2.0,2.0,
2.0,2.0,47.4,47.4,47.4,47.4,47.4,47.4,47.4,47.4,47.4)
Temp.Ar <- c(78,89,89,72,84,87,74,87,88,76,
65,67,62,70,73,65,76,82,76,83,82,69,74,76,69,75,76)
dados.2 <- data.frame(ID,B2,Sol,Humidade,Temp.Ar)
rm(list=c("ID","B2","Sol","Humidade","Temp.Ar"))
knitr::kable(dados.2)
minQuad <- function(b){
return(sum((dados.1$Caro-b[1]-dados.1$Barato*b[2])^2))
}
(b <-optim(par=c(0,0),minQuad)$par)
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2])
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2],lty=2,col="red")
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2],lty=2,lwd=2,col="red")
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2],lty=1.5,lwd=2,col="red")
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2],lty=2,lwd=1.5,col="red")
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2],lty=2,lwd=1.7,col="red")
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2],lty=2,lwd=1.87,col="red")
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2],lty=2,lwd=1.9,col="red")
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2],lty=2,lwd=2,col="red")
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2],lty=2,lwd=1.99,col="red")
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2],lty=2,lwd=2,col="red")
matriz <- cbind(rep(1,27),as.matrix(dados.2[,-(1:2)]))
minQuad <- function(b){
return(sum((dados.2$B2-matriz%*%b)^2))
}
(b <-optim(par=c(min(dados.2$B2),0,0,0),minQuad)$par)
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados.2$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados.2$B2,xlab="Estimativa de B2",ylab="Valor real de B2",
col=c("blue","red")[as.numeric(dados.2$Humidade>7)])
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM =",round(mean((dados.2$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados.2$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados.2$B2,xlab="Estimativa de B2",ylab="Valor real de B2",
col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM =",round(mean((dados.2$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados.2$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados.2$B2,xlab="Estimativa de B2",ylab="Valor real de B2",
col=c("blue","red")[as.numeric(dados.2$Humidade>2)+1])
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM =",round(mean((dados.2$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados.2$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados.2$B2,xlab="Estimativa de B2",ylab="Valor real de B2",
col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM =",round(mean((dados.2$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados.2$B2,resid,xlab="Vitamina B2",ylab="Resíduos",
col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados.2$B2,xlab="Estimativa de B2",ylab="Valor real de B2",
col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM =",round(mean((dados.2$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados.2$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados.2$B2,xlab="Estimativa de B2",ylab="Valor real de B2",col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM =",round(mean((dados.2$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
matriz <- cbind(rep(1,27),as.matrix(dados.2[,-(1:2)]), dados.2$Humidade^2)
(b <-optim(par=c(100,0,0,0,0),minQuad)$par)
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados.2$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados.2$B2,xlab="Estimativa de B2",ylab="Valor real de B2",col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM =",round(mean((dados.2$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados.2$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados.2$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM =",round(mean((dados.2$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados.2$B2,resid,xlab="Vitamina B2",ylab="Resíduos",
col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
legend("bottomright",bty="n",legend=c("Humidade > 7", "Humidade <=7"),col=c("blue","red"),pch=1)
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados.2$B2,xlab="Estimativa de B2",ylab="Valor real de B2",
col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM =",round(mean((dados.2$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados.2$B2,resid,xlab="Vitamina B2",ylab="Resíduos",
col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados.2$B2,xlab="Estimativa de B2",ylab="Valor real de B2",
col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
abline(a=0,b=1,lty=2,col="grey30")
legend("topleft",bty="n",legend=c("Humidade > 7", "Humidade <=7"),col=c("blue","red"),pch=1)
mtext(paste("EQM =",round(mean((dados.2$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados.2$B2,resid,xlab="Vitamina B2",ylab="Resíduos",
col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados.2$B2,xlab="Estimativa de B2",ylab="Valor real de B2",
col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
abline(a=0,b=1,lty=2,col="grey30")
legend("topleft",legend=c("Humidade > 7", "Humidade <=7"),col=c("blue","red"),pch=1)
mtext(paste("EQM =",round(mean((dados.2$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(resid,dados.1$Caro)
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1$Caro,resid)
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <-  b[1] + b[2]*dados.1$Barato - dados.1$Caro
plot(dados.1$Caro,resid)
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1$Caro,resid)
#| fig-align: "center"
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2],lty=2,lwd=2,col="red")
#| fig-align: "center"
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2],lty=2,lwd=2,col="red")
minQuad <- function(b){
return(sum((dados.1$Caro-b[1]-dados.1$Barato*b[2])^2))
}
(b <-optim(par=c(0,0),minQuad)$par)
#| fig-align: "center"
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2],lty=2,lwd=2,col="red")
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1$Caro,resid)
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1$Caro,resid)
abline(h=0,lty=2,col="grey30")
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1$Caro,resid,ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1$Caro,resid,ylab="Resíduos",xlab="Caro")
abline(h=0,lty=2,col="grey30")
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1$Caro,resid,ylab="Resíduos",xlab="Ácido Caro")
abline(h=0,lty=2,col="grey30")
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1[2],resid,ylab="Resíduos",xlab="Ácido Caro")
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1[,2],resid,ylab="Resíduos",xlab="Ácido Caro")
abline(h=0,lty=2,col="grey30")
plot(b[1] + b[2]*dados.1$Barato,dados.1$Caro)
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1[,2],resid,ylab="Resíduos",xlab="Ácido Caro")
abline(h=0,lty=2,col="grey30")
plot(b[1] + b[2]*dados.1$Barato,dados.1$Caro)
abline(a=0,b=1,lty=2,col="grey30")
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1[,2],resid,ylab="Resíduos",xlab="Ácido Caro")
abline(h=0,lty=2,col="grey30")
plot(b[1] + b[2]*dados.1$Barato,dados.1$Caro)
abline(a=0,b=1,lty=2,col="grey30",xlab="Estimativa de Caro",ylab="Valor real de Caro")
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1[,2],resid,ylab="Resíduos",xlab="Ácido Caro")
abline(h=0,lty=2,col="grey30")
plot(b[1] + b[2]*dados.1$Barato,dados.1$Caro,xlab="Estimativa de Caro",ylab="Valor real de Caro")
abline(a=0,b=1,lty=2,col="grey30")
par(mfrow=c(2,1),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1[,2],resid,ylab="Resíduos",xlab="Caro")
abline(h=0,lty=2,col="grey30")
plot(b[1] + b[2]*dados.1$Barato,dados.1$Caro,xlab="Estimativa de Caro",ylab="Valor real de Caro")
abline(a=0,b=1,lty=2,col="grey30")
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1[,2],resid,ylab="Resíduos",xlab="Caro")
abline(h=0,lty=2,col="grey30")
plot(b[1] + b[2]*dados.1$Barato,dados.1$Caro,xlab="Estimativa de Caro",ylab="Valor real de Caro")
abline(a=0,b=1,lty=2,col="grey30")
matriz <- cbind(rep(1,27),as.matrix(dados.2[,-(1:2)]))
minQuad <- function(b){
return(sum((dados.2$B2-matriz%*%b)^2))
}
(b <-optim(par=c(min(dados.2$B2),0,0,0),minQuad)$par)
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
#grafico 1
par(mfrow=c(2,1),mar=c(4.1,4.1,1,1))
plot(dados.2$B2,resid,xlab="Vitamina B2",ylab="Resíduos",
col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
abline(h=0,lty=2,col="grey30")
#grafico 2
plot(matriz%*%b,dados.2$B2,xlab="Estimativa de B2",ylab="Valor real de B2",
col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
abline(a=0,b=1,lty=2,col="grey30")
legend("topleft",legend=c("Humidade > 7", "Humidade <=7"),col=c("blue","red"),pch=1)
mtext(paste("EQM =",round(mean((dados.2$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
matriz <- cbind(rep(1,27),as.matrix(dados.2[,-(1:2)]), dados.2$Humidade^2)
(b <-optim(par=c(100,0,0,0,0),minQuad)$par)
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados.2$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados.2$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM =",round(mean((dados.2$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
par(mfrow=c(2,1),mar=c(4.1,4.1,1,1))
plot(dados.2$B2,resid,xlab="Vitamina B2",ylab="Resíduos")
abline(h=0,lty=2,col="grey30")
plot(matriz%*%b,dados.2$B2,xlab="Estimativa de B2",ylab="Valor real de B2")
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM =",round(mean((dados.2$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1[,2],resid,ylab="Resíduos",xlab="Caro")
abline(h=0,lty=2,col="grey30")
plot(b[1] + b[2]*dados.1$Barato,dados.1$Caro,
xlab="Estimativa de Caro",ylab="Valor real de Caro")
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM =",round(mean((dados.2$B2- b[1] - b[2]*dados.1$Barato)^2),3)),
side=1,padj=-2,col="blue4")
(dados.2$B2 - b[1] - b[2]*dados.1$Barato)^2
#| fig-align: "center"
par(mar=c(4.1,4.1,1,1))
plot(Caro ~ Barato,data=dados.1)
abline(a=b[1],b=b[2],lty=2,lwd=2,col="red")
minQuad <- function(b){
return(sum((dados.1$Caro-b[1]-dados.1$Barato*b[2])^2))
}
(b <-optim(par=c(0,0),minQuad)$par)
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1[,2],resid,ylab="Resíduos",xlab="Caro")
abline(h=0,lty=2,col="grey30")
plot(b[1] + b[2]*dados.1$Barato,dados.1$Caro,
xlab="Estimativa de Caro",ylab="Valor real de Caro")
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM =",round(mean((dados.2$B2 - b[1] - b[2]*dados.1$Barato)^2),3)),
side=1,padj=-2,col="blue4")
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1[,2],resid,ylab="Resíduos",xlab="Caro")
abline(h=0,lty=2,col="grey30")
plot(b[1] + b[2]*dados.1$Barato,dados.1$Caro,
xlab="Estimativa de Caro",ylab="Valor real de Caro")
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM =",round(mean((dados.1$Caro - b[1] - b[2]*dados.1$Barato)^2),3)),
side=1,padj=-2,col="blue4")
sd(resid)
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
resid <- dados.1$Caro - b[1] - b[2]*dados.1$Barato
plot(dados.1[,2],resid,ylab="Resíduos",xlab="Caro")
abline(h=0,lty=2,col="grey30")
plot(b[1] + b[2]*dados.1$Barato,dados.1$Caro,
xlab="Estimativa de Caro",ylab="Valor real de Caro")
abline(a=0,b=1,lty=2,col="grey30")
mtext(paste("EQM =",round(mean((dados.1$Caro - b[1] - b[2]*dados.1$Barato)^2),3)),
side=1,padj=-2,col="blue4")
var(resid)
matriz <- cbind(rep(1,27),as.matrix(dados.2[,-(1:2)]))
minQuad <- function(b){
return(sum((dados.2$B2-matriz%*%b)^2))
}
(b <-optim(par=c(min(dados.2$B2),0,0,0),minQuad)$par)
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
var(resid)
#| fig-align: "center"
resid <- dados.2$B2-matriz%*%b
#grafico 1
par(mfrow=c(1,2),mar=c(4.1,4.1,1,1))
plot(dados.2$B2,resid,xlab="Vitamina B2",ylab="Resíduos",
col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
abline(h=0,lty=2,col="grey30")
#grafico 2
plot(matriz%*%b,dados.2$B2,xlab="Estimativa de B2",ylab="Valor real de B2",
col=c("blue","red")[as.numeric(dados.2$Humidade>7)+1])
abline(a=0,b=1,lty=2,col="grey30")
legend("topleft",legend=c("Humidade > 7", "Humidade <=7"),col=c("blue","red"),pch=1)
mtext(paste("EQM =",round(mean((dados.2$B2-matriz%*%b)^2),3)),
side=1,padj=-2,col="blue4")
